import{r as m,j as e,R as W,_ as U}from"./index-ljvJ6QJz.js";W.lazy(()=>U(()=>import("./FinanceChart-Bfi4xqq3.js"),__vite__mapDeps([0,1,2])));function P({currentUser:u,token:c}){const[h,F]=m.useState([]),[j,l]=m.useState(""),[o,z]=m.useState({incomes:[],expenses:[],investments:[],totalIncome:0,totalExpense:0,totalInvestment:0,net:0}),[B,S]=m.useState(!1),[M,E]=m.useState(!1),[q,f]=m.useState(""),[x,d]=m.useState({}),[b,R]=m.useState(!1),[I,T]=m.useState(!1);m.useEffect(()=>{k()},[]),m.useEffect(()=>{g()},[]);async function k(){S(!0),f("");try{const s=c?{Authorization:"Bearer "+c}:{},t=await fetch("/api/users",{headers:s});if(!t.ok)throw new Error("Failed to load users: "+t.status);const a=await t.json();F(a)}catch(s){f("Failed to load users: "+s.message)}S(!1)}async function L(s){if(s.preventDefault(),!u||u.accountType!=="group"){l("Adding users is only available for group accounts");return}const t=s.target,a={name:t.name.value,email:t.email.value,monthlyIncome:Number(t.monthlyIncome.value)};try{const r={"Content-Type":"application/json"};c&&(r.Authorization="Bearer "+c);const i=await fetch("/api/users",{method:"POST",headers:r,body:JSON.stringify(a)});if(!i.ok){const n=await i.text().catch(()=>i.statusText);throw new Error("Create failed: "+n)}t.reset(),k(),l("User created"),T(!1),setTimeout(()=>l(""),2e3)}catch(r){l("Error: "+r.message)}}async function g(){E(!0),f("");try{const s=c?{Authorization:"Bearer "+c}:{},t=await fetch("/api/finance/summary",{headers:s});if(!t.ok)throw new Error("Failed to load finance: "+t.status);const a=await t.json();z(a)}catch(s){f("Failed to load finance: "+s.message)}E(!1)}const D=h.length,_=h.length?h.reduce((s,t)=>s+Number(t.monthlyIncome||0),0)/h.length:0;async function y(s,t){t.preventDefault();const a=t.target,r={amount:Number(a.amount.value),description:a.description.value,date:a.date.value||void 0};s==="expenses"&&a.category&&(r.category=a.category.value);try{const i={"Content-Type":"application/json"};c&&(i.Authorization="Bearer "+c);const n=await fetch("/api/finance/"+s,{method:"POST",headers:i,body:JSON.stringify(r)});if(!n.ok){const p=await n.text().catch(()=>n.statusText);throw new Error("Create failed: "+p)}a.reset(),await g(),l(s.charAt(0).toUpperCase()+s.slice(1)+" added successfully!"),setTimeout(()=>l(""),3e3)}catch(i){l("Error: "+i.message),setTimeout(()=>l(""),3e3)}}async function v(s,t){if(confirm("Delete this record?"))try{const a={};c&&(a.Authorization="Bearer "+c);const r=await fetch("/api/finance/"+s+"/"+t,{method:"DELETE",headers:a});if(!r.ok)throw new Error("Delete failed: "+await r.text().catch(()=>r.statusText));await g(),l("Deleted successfully!"),setTimeout(()=>l(""),3e3)}catch(a){l("Error: "+a.message),setTimeout(()=>l(""),3e3)}}function N(s,t){d(a=>({...a,[s+"_"+t.id]:t}))}async function C(s,t){const a=s+"_"+t,r=x[a];if(r)try{const i={"Content-Type":"application/json"};c&&(i.Authorization="Bearer "+c);const n={amount:Number(r.amount),description:r.description,date:r.date};if(isNaN(n.amount)||n.amount<=0){l("Amount must be a positive number"),setTimeout(()=>l(""),3e3);return}const p=await fetch("/api/finance/"+s+"/"+t,{method:"PUT",headers:i,body:JSON.stringify(n)});if(!p.ok)throw new Error("Update failed: "+await p.text().catch(()=>p.statusText));d(O=>{const A={...O};return delete A[a],A}),await g(),l("Updated successfully!"),setTimeout(()=>l(""),3e3)}catch(i){l("Error: "+i.message),setTimeout(()=>l(""),3e3)}}function w(s,t){const a=s+"_"+t;d(r=>{const i={...r};return delete i[a],i})}return e.jsxs("div",{className:"dashboard-root",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{children:"Overview"}),e.jsxs("div",{className:"header-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx("div",{className:"meta-value",children:D}),e.jsx("div",{className:"meta-label",children:"Users"})]}),e.jsxs("div",{className:"meta-item",children:[e.jsxs("div",{className:"meta-value",children:["â‚¹",_.toFixed(2)]}),e.jsx("div",{className:"meta-label",children:"Avg Monthly Income"})]}),u&&u.accountType==="group"&&e.jsxs("div",{className:"meta-item members-dropdown",children:[e.jsxs("button",{className:"members-toggle",onClick:()=>R(!b),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"10px 16px",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)"},children:["ðŸ‘¥ Members (",D,")",e.jsx("span",{style:{transform:b?"rotate(180deg)":"rotate(0)",transition:"transform 0.2s"},children:"â–¼"})]}),b&&e.jsxs("div",{className:"members-list",style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"white",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 10px 40px rgba(0,0,0,0.1)",minWidth:"280px",maxHeight:"400px",overflow:"auto",zIndex:100},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"2px solid #f1f5f9",display:"flex",justifyContent:"space-between",alignItems:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[e.jsx("span",{style:{fontWeight:"700",fontSize:"14px",color:"white"},children:"Group Members"}),e.jsx("button",{onClick:()=>T(!I),style:{background:"rgba(255,255,255,0.2)",color:"white",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:s=>s.currentTarget.style.background="rgba(255,255,255,0.3)",onMouseLeave:s=>s.currentTarget.style.background="rgba(255,255,255,0.2)",children:"+ Add Member"})]}),I&&e.jsxs("form",{onSubmit:L,style:{padding:"16px",borderBottom:"2px solid #f1f5f9",background:"#f8fafc"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsx("input",{name:"name",placeholder:"Full name",required:!0,style:{padding:"10px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"13px"}}),e.jsx("input",{name:"email",type:"email",placeholder:"email@domain.com",required:!0,style:{padding:"10px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"13px"}}),e.jsx("input",{name:"monthlyIncome",type:"number",placeholder:"Monthly income",required:!0,style:{padding:"10px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"13px"}}),e.jsx("button",{type:"submit",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"10px",border:"none",borderRadius:"6px",fontWeight:"600",fontSize:"13px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:s=>s.currentTarget.style.transform="scale(1.02)",onMouseLeave:s=>s.currentTarget.style.transform="scale(1)",children:"Create Member"})]}),j&&e.jsx("div",{style:{marginTop:"8px",fontSize:"12px",color:j.includes("Error")?"#ef4444":"#10b981"},children:j})]}),B?e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading..."}):h.length===0?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94a3b8"},children:"No members"}):h.map(s=>e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #f1f5f9",display:"flex",flexDirection:"column",gap:"4px",transition:"background 0.2s",cursor:"default"},onMouseEnter:t=>t.currentTarget.style.background="#f8fafc",onMouseLeave:t=>t.currentTarget.style.background="white",children:[e.jsx("div",{style:{fontWeight:"600",color:"#1e293b",fontSize:"14px"},children:s.name}),e.jsx("div",{style:{fontSize:"12px",color:"#64748b"},children:s.email}),e.jsxs("div",{style:{fontSize:"13px",color:"#667eea",fontWeight:"600"},children:["â‚¹",Number(s.monthlyIncome).toFixed(2),"/month"]})]},s.id))]})]})]})]}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsxs("section",{className:"card finance-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"ðŸ’° Finance Summary"})}),M?e.jsx("div",{className:"spinner"}):e.jsxs("div",{className:"finance-body",children:[e.jsxs("div",{className:"finance-grid",children:[e.jsxs("div",{className:"finance-stat income-stat",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ“ˆ"}),e.jsxs("div",{children:[e.jsx("div",{className:"stat-label",children:"Total Income"}),e.jsxs("div",{className:"stat-value",children:["â‚¹",Number(o.totalIncome||0).toFixed(2)]})]})]}),e.jsxs("div",{className:"finance-stat expense-stat",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ’¸"}),e.jsxs("div",{children:[e.jsx("div",{className:"stat-label",children:"Total Expense"}),e.jsxs("div",{className:"stat-value",children:["â‚¹",Number(o.totalExpense||0).toFixed(2)]})]})]}),e.jsxs("div",{className:"finance-stat investment-stat",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ’Ž"}),e.jsxs("div",{children:[e.jsx("div",{className:"stat-label",children:"Total Investment"}),e.jsxs("div",{className:"stat-value",children:["â‚¹",Number(o.totalInvestment||0).toFixed(2)]})]})]}),e.jsxs("div",{className:"finance-stat net-stat",children:[e.jsx("div",{className:"stat-icon",children:Number(o.net||0)>=0?"âœ…":"âš ï¸"}),e.jsxs("div",{children:[e.jsx("div",{className:"stat-label",children:"Net"}),e.jsxs("div",{className:"stat-value",style:{color:Number(o.net||0)>=0?"var(--success, #10b981)":"var(--danger, #ef4444)"},children:["â‚¹",Number(o.net||0).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"recent-lists",style:{marginTop:20},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[e.jsx("span",{children:"ðŸ’µ"})," Recent Incomes"]}),e.jsx("div",{className:"recent-block",children:o.incomes.length===0?e.jsx("div",{className:"muted",children:"No incomes"}):o.incomes.map(s=>{const t="incomes_"+s.id,a=!!x[t],r=x[t]||s;return e.jsxs("div",{className:"finance-row",children:[e.jsx("div",{className:"finance-row-amount",children:a?e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:i=>d(n=>({...n,[t]:{...n[t],amount:i.target.value}}))}):"â‚¹"+Number(s.amount).toFixed(2)}),e.jsx("div",{className:"finance-row-meta",children:a?e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{value:r.description||"",onChange:i=>d(n=>({...n,[t]:{...n[t],description:i.target.value}})),placeholder:"Description"}),e.jsx("input",{type:"date",value:r.date||"",onChange:i=>d(n=>({...n,[t]:{...n[t],date:i.target.value}}))})]}):(s.description||"")+(s.date?" â€¢ "+s.date:"")}),e.jsx("div",{style:{marginLeft:"auto"},children:a?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-ghost",onClick:()=>C("incomes",s.id),children:"Save"}),e.jsx("button",{className:"btn-ghost",onClick:()=>w("incomes",s.id),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-ghost",onClick:()=>N("incomes",s),children:"Edit"}),e.jsx("button",{className:"btn-ghost",onClick:()=>v("incomes",s.id),children:"Delete"})]})})]},s.id)})}),e.jsxs("h4",{style:{marginTop:20,display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[e.jsx("span",{children:"ðŸ›’"})," Recent Expenses"]}),e.jsx("div",{className:"recent-block",children:o.expenses.length===0?e.jsx("div",{className:"muted",children:"No expenses"}):o.expenses.map(s=>{const t="expenses_"+s.id,a=!!x[t],r=x[t]||s;return e.jsxs("div",{className:"finance-row",children:[e.jsx("div",{className:"finance-row-amount",children:a?e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:i=>d(n=>({...n,[t]:{...n[t],amount:i.target.value}}))}):"â‚¹"+Number(s.amount).toFixed(2)}),e.jsx("div",{className:"finance-row-meta",children:a?e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{value:r.description||"",onChange:i=>d(n=>({...n,[t]:{...n[t],description:i.target.value}})),placeholder:"Description"}),e.jsx("input",{type:"date",value:r.date||"",onChange:i=>d(n=>({...n,[t]:{...n[t],date:i.target.value}}))})]}):(s.description||"")+(s.date?" â€¢ "+s.date:"")}),e.jsx("div",{style:{marginLeft:"auto"},children:a?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-ghost",onClick:()=>C("expenses",s.id),children:"Save"}),e.jsx("button",{className:"btn-ghost",onClick:()=>w("expenses",s.id),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-ghost",onClick:()=>N("expenses",s),children:"Edit"}),e.jsx("button",{className:"btn-ghost",onClick:()=>v("expenses",s.id),children:"Delete"})]})})]},s.id)})}),e.jsxs("h4",{style:{marginTop:20,display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[e.jsx("span",{children:"ðŸš€"})," Recent Investments"]}),e.jsx("div",{className:"recent-block",children:o.investments.length===0?e.jsx("div",{className:"muted",children:"No investments"}):o.investments.map(s=>{const t="investments_"+s.id,a=!!x[t],r=x[t]||s;return e.jsxs("div",{className:"finance-row",children:[e.jsx("div",{className:"finance-row-amount",children:a?e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:i=>d(n=>({...n,[t]:{...n[t],amount:i.target.value}}))}):"â‚¹"+Number(s.amount).toFixed(2)}),e.jsx("div",{className:"finance-row-meta",children:a?e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{value:r.description||"",onChange:i=>d(n=>({...n,[t]:{...n[t],description:i.target.value}})),placeholder:"Description"}),e.jsx("input",{type:"date",value:r.date||"",onChange:i=>d(n=>({...n,[t]:{...n[t],date:i.target.value}}))})]}):(s.description||"")+(s.date?" â€¢ "+s.date:"")}),e.jsx("div",{style:{marginLeft:"auto"},children:a?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-ghost",onClick:()=>C("investments",s.id),children:"Save"}),e.jsx("button",{className:"btn-ghost",onClick:()=>w("investments",s.id),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-ghost",onClick:()=>N("investments",s),children:"Edit"}),e.jsx("button",{className:"btn-ghost",onClick:()=>v("investments",s.id),children:"Delete"})]})})]},s.id)})})]})]})]}),e.jsxs("section",{className:"card activity-card",children:[e.jsx("h3",{children:"ðŸ“ˆ Trending Stocks"}),e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[{symbol:"RELIANCE",name:"Reliance Industries",price:"â‚¹2,847.50",change:"+2.3%",changeColor:"#10b981"},{symbol:"TCS",name:"Tata Consultancy",price:"â‚¹3,654.20",change:"+1.8%",changeColor:"#10b981"},{symbol:"INFY",name:"Infosys",price:"â‚¹1,523.40",change:"-0.5%",changeColor:"#ef4444"},{symbol:"HDFCBANK",name:"HDFC Bank",price:"â‚¹1,687.90",change:"+0.9%",changeColor:"#10b981"},{symbol:"ICICIBANK",name:"ICICI Bank",price:"â‚¹1,134.75",change:"+1.2%",changeColor:"#10b981"}].map((s,t)=>e.jsxs("div",{className:"stock-item",children:[e.jsxs("div",{children:[e.jsx("div",{className:"stock-symbol",children:s.symbol}),e.jsx("div",{className:"stock-name",children:s.name})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{className:"stock-price",children:s.price}),e.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:s.changeColor},children:s.change})]})]},t))}),e.jsx("div",{className:"stock-disclaimer",children:e.jsxs("div",{style:{fontSize:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"âš ï¸"}),e.jsx("span",{children:"Stock prices are indicative. Consult a financial advisor before investing."})]})})]})]}),e.jsxs("div",{className:"add-row",children:[e.jsxs("section",{className:"card add-card",children:[e.jsx("h3",{style:{display:"flex",alignItems:"center",gap:"8px"},children:"ðŸ’µ Add Income"}),e.jsxs("form",{onSubmit:s=>y("incomes",s),style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("label",{className:"form-field",children:["Amount ",e.jsx("input",{name:"amount",type:"number",step:"0.01",placeholder:"0.00",required:!0})]}),e.jsxs("label",{className:"form-field",children:["Description ",e.jsx("input",{name:"description",placeholder:"Description"})]}),e.jsxs("label",{className:"form-field",children:["Date ",e.jsx("input",{name:"date",type:"date"})]}),e.jsx("div",{style:{height:"60px"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn-primary",type:"submit",children:"Add Income"})})]})]}),e.jsxs("section",{className:"card add-card",children:[e.jsx("h3",{style:{display:"flex",alignItems:"center",gap:"8px"},children:"ðŸ›’ Add Expense"}),e.jsxs("form",{onSubmit:s=>y("expenses",s),style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("label",{className:"form-field",children:["Amount ",e.jsx("input",{name:"amount",type:"number",step:"0.01",placeholder:"0.00",required:!0})]}),e.jsxs("label",{className:"form-field",children:["Description ",e.jsx("input",{name:"description",placeholder:"Description"})]}),e.jsxs("label",{className:"form-field",children:["Date ",e.jsx("input",{name:"date",type:"date"})]}),e.jsxs("label",{className:"form-field",children:["Category",e.jsxs("select",{name:"category",children:[e.jsx("option",{value:"Food",children:"Food"}),e.jsx("option",{value:"Transport",children:"Transport"}),e.jsx("option",{value:"Entertainment",children:"Entertainment"}),e.jsx("option",{value:"Bills",children:"Bills"}),e.jsx("option",{value:"Shopping",children:"Shopping"}),e.jsx("option",{value:"Healthcare",children:"Healthcare"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn-primary",type:"submit",children:"Add Expense"})})]})]}),e.jsxs("section",{className:"card add-card",children:[e.jsx("h3",{style:{display:"flex",alignItems:"center",gap:"8px"},children:"ðŸš€ Add Investment"}),e.jsxs("form",{onSubmit:s=>y("investments",s),style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("label",{className:"form-field",children:["Amount ",e.jsx("input",{name:"amount",type:"number",step:"0.01",placeholder:"0.00",required:!0})]}),e.jsxs("label",{className:"form-field",children:["Description ",e.jsx("input",{name:"description",placeholder:"Description"})]}),e.jsxs("label",{className:"form-field",children:["Date ",e.jsx("input",{name:"date",type:"date"})]}),e.jsx("div",{style:{height:"60px"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn-primary",type:"submit",children:"Add Investment"})})]})]})]})]})]})}export{P as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/FinanceChart-Bfi4xqq3.js","assets/index-ljvJ6QJz.js","assets/index-BBUc9ZkU.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
